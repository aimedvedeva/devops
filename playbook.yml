- hosts: app
  tasks:
    - name: Create the deployment folder
      file:
        path: /home/vagrant
        state: directory
        mode: '777'
      become: True

    - name: Copy Artifact
      copy:
        src: main
        dest: /home/vagrant/main
        mode: a+x

    - name: Copy Service Definition
      copy:
        src: myapp.service
        dest: /etc/systemd/system/myapp.service
      become: true
      
    - name: Start systemd
      systemd:
        name: myapp
        state: started
        enabled: true
      become: true

